2025-01-18 19:43:20,256 - root - INFO - ********** Run 1 starts. **********
2025-01-18 19:43:20,256 - root - INFO - configuration is Namespace(batch_size=200, channel_embedding_dim=50, dataset_name='wikipedia', device='cpu', dropout=0.1, edge_bank_memory_mode='unlimited_memory', gpu=0, learning_rate=0.0001, load_best_configs=False, max_input_sequence_length=32, model_name='FreeDyG', negative_sample_strategy='random', num_epochs=100, num_heads=2, num_layers=2, num_neighbors=20, num_runs=5, num_walk_heads=8, optimizer='Adam', patch_size=1, patience=20, position_feat_dim=172, sample_neighbor_strategy='recent', save_model_name='FreeDyG_seed0', seed=0, test_interval_epochs=10, test_ratio=0.15, time_feat_dim=100, time_gap=2000, time_scaling_factor=1e-06, time_window_mode='fixed_proportion', val_ratio=0.15, walk_length=1, weight_decay=0.0)
2025-01-18 19:43:20,327 - root - INFO - model -> Sequential(
  (0): FreeDyG(
    (time_encoder): TimeEncoder(
      (w): Linear(in_features=1, out_features=100, bias=True)
    )
    (nif_encoder): NIFEncoder(
      (nif_encode_layer): Sequential(
        (0): Linear(in_features=1, out_features=50, bias=True)
        (1): ReLU()
        (2): Linear(in_features=50, out_features=50, bias=True)
      )
    )
    (projection_layer): ModuleDict(
      (node): Linear(in_features=172, out_features=172, bias=True)
      (edge): Linear(in_features=172, out_features=172, bias=True)
      (time): Linear(in_features=100, out_features=172, bias=True)
      (nif): Linear(in_features=50, out_features=172, bias=True)
    )
    (reduce_layer): Linear(in_features=688, out_features=172, bias=True)
    (mlp_mixers): ModuleList(
      (0-1): 2 x MLPMixer(
        (token_norm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
        (token_feedforward): FeedForwardNet(
          (ffn): Sequential(
            (0): Linear(in_features=32, out_features=16, bias=True)
            (1): GELU(approximate='none')
            (2): Dropout(p=0.1, inplace=False)
            (3): Linear(in_features=16, out_features=32, bias=True)
            (4): Dropout(p=0.1, inplace=False)
          )
        )
        (filter): FilterLayer(
          (Dropout): Dropout(p=0.1, inplace=False)
        )
        (channel_norm): LayerNorm((172,), eps=1e-05, elementwise_affine=True)
        (channel_feedforward): FeedForwardNet(
          (ffn): Sequential(
            (0): Linear(in_features=172, out_features=688, bias=True)
            (1): GELU(approximate='none')
            (2): Dropout(p=0.1, inplace=False)
            (3): Linear(in_features=688, out_features=172, bias=True)
            (4): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (weightagg): Linear(in_features=172, out_features=1, bias=True)
  )
  (1): MergeLayer(
    (fc1): Linear(in_features=344, out_features=172, bias=True)
    (fc2): Linear(in_features=172, out_features=1, bias=True)
    (act): ReLU()
  )
)
2025-01-18 19:43:20,331 - root - INFO - model name: FreeDyG, #parameters: 3024880 B, 2953.984375 KB, 2.8847503662109375 MB.
2025-01-18 19:50:14,813 - root - INFO - Epoch: 1, learning rate: 0.0001, train loss: 0.3317
2025-01-18 19:50:14,814 - root - INFO - train average_precision, 0.9308
2025-01-18 19:50:14,814 - root - INFO - train roc_auc, 0.9323
2025-01-18 19:50:14,814 - root - INFO - validate loss: 0.1398
2025-01-18 19:50:14,815 - root - INFO - validate average_precision, 0.9881
2025-01-18 19:50:14,815 - root - INFO - validate roc_auc, 0.9870
2025-01-18 19:50:14,815 - root - INFO - new node validate loss: 0.1664
2025-01-18 19:50:14,816 - root - INFO - new node validate average_precision, 0.9837
2025-01-18 19:50:14,816 - root - INFO - new node validate roc_auc, 0.9823
2025-01-18 19:50:14,819 - root - INFO - save model ./saved_models/FreeDyG/wikipedia/FreeDyG_seed0/FreeDyG_seed0.pkl
2025-01-18 19:57:28,476 - root - INFO - Epoch: 2, learning rate: 0.0001, train loss: 0.1721
2025-01-18 19:57:28,477 - root - INFO - train average_precision, 0.9855
2025-01-18 19:57:28,478 - root - INFO - train roc_auc, 0.9843
2025-01-18 19:57:28,478 - root - INFO - validate loss: 0.1187
2025-01-18 19:57:28,478 - root - INFO - validate average_precision, 0.9920
2025-01-18 19:57:28,479 - root - INFO - validate roc_auc, 0.9915
2025-01-18 19:57:28,479 - root - INFO - new node validate loss: 0.1326
2025-01-18 19:57:28,479 - root - INFO - new node validate average_precision, 0.9895
2025-01-18 19:57:28,479 - root - INFO - new node validate roc_auc, 0.9890
2025-01-18 19:57:28,480 - root - INFO - save model ./saved_models/FreeDyG/wikipedia/FreeDyG_seed0/FreeDyG_seed0.pkl
2025-01-18 20:04:29,246 - root - INFO - Epoch: 3, learning rate: 0.0001, train loss: 0.1283
2025-01-18 20:04:29,246 - root - INFO - train average_precision, 0.9895
2025-01-18 20:04:29,246 - root - INFO - train roc_auc, 0.9887
2025-01-18 20:04:29,247 - root - INFO - validate loss: 0.1116
2025-01-18 20:04:29,247 - root - INFO - validate average_precision, 0.9924
2025-01-18 20:04:29,247 - root - INFO - validate roc_auc, 0.9923
2025-01-18 20:04:29,247 - root - INFO - new node validate loss: 0.1230
2025-01-18 20:04:29,248 - root - INFO - new node validate average_precision, 0.9903
2025-01-18 20:04:29,248 - root - INFO - new node validate roc_auc, 0.9900
2025-01-18 20:04:29,248 - root - INFO - save model ./saved_models/FreeDyG/wikipedia/FreeDyG_seed0/FreeDyG_seed0.pkl
2025-01-18 20:11:43,440 - root - INFO - Epoch: 4, learning rate: 0.0001, train loss: 0.1225
2025-01-18 20:11:43,441 - root - INFO - train average_precision, 0.9902
2025-01-18 20:11:43,441 - root - INFO - train roc_auc, 0.9896
2025-01-18 20:11:43,442 - root - INFO - validate loss: 0.1141
2025-01-18 20:11:43,442 - root - INFO - validate average_precision, 0.9930
2025-01-18 20:11:43,442 - root - INFO - validate roc_auc, 0.9927
2025-01-18 20:11:43,443 - root - INFO - new node validate loss: 0.1238
2025-01-18 20:11:43,443 - root - INFO - new node validate average_precision, 0.9910
2025-01-18 20:11:43,443 - root - INFO - new node validate roc_auc, 0.9905
2025-01-18 20:11:43,444 - root - INFO - save model ./saved_models/FreeDyG/wikipedia/FreeDyG_seed0/FreeDyG_seed0.pkl
2025-01-18 20:18:44,880 - root - INFO - Epoch: 5, learning rate: 0.0001, train loss: 0.1191
2025-01-18 20:18:44,880 - root - INFO - train average_precision, 0.9906
2025-01-18 20:18:44,881 - root - INFO - train roc_auc, 0.9900
2025-01-18 20:18:44,881 - root - INFO - validate loss: 0.1072
2025-01-18 20:18:44,881 - root - INFO - validate average_precision, 0.9931
2025-01-18 20:18:44,881 - root - INFO - validate roc_auc, 0.9930
2025-01-18 20:18:44,882 - root - INFO - new node validate loss: 0.1197
2025-01-18 20:18:44,882 - root - INFO - new node validate average_precision, 0.9910
2025-01-18 20:18:44,882 - root - INFO - new node validate roc_auc, 0.9906
2025-01-18 20:18:44,883 - root - INFO - save model ./saved_models/FreeDyG/wikipedia/FreeDyG_seed0/FreeDyG_seed0.pkl
